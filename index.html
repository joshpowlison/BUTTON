<!DOCTYPE HTML>
<html>
<head>
	<title>BUTTON</title>
	<style>
		body{
			margin:0;
			padding:0;
			height:100vh;
			width:100vw;
		}
		
		body.pressed{
			cursor:pointer;
		}
	
		#button{
			background-color:red;
			border-radius:100%;
			
			width:10vw;
			height:10vw;
			margin:auto;
		}
		
		#button.pressed{
			background-color:#aa0000;
		}
		
		#number{
			text-align:center;
		}
	</style>
</head>
<body>
	<div id="number">0</div> <div id="button"></div>
	<script>
		const BODY			= document.body;
		const BUTTON		= document.getElementById('button');
		const NUMBER		= document.getElementById('number');
		
		// Bitmasks for all possible presses
		const MOUSE			= 1 << 0;
		const TOUCH0		= 1 << 1;
		const TOUCH1		= 1 << 2;
		const TOUCH2		= 1 << 3;
		const TOUCH3		= 1 << 4;
		const TOUCH4		= 1 << 5;
		const TOUCH5		= 1 << 6;
		const TOUCH6		= 1 << 7;
		const TOUCH7		= 1 << 8;
		const TOUCH8		= 1 << 9;
		const TOUCH9		= 1 << 10;
		
		var number			= 0;
		var windowPresses	= 0;
		var buttonPresses	= 0;
	
		// |= adds to the bitmask
		// ^= toggles from the bitmask
		// &= ~PROP always removes from the bitmask
		// & checks if true
	
		function incrementNumber(event){
			number++;
			NUMBER.innerHTML = number;
		}
		
		function press(event){
			// Touches (fingers, stylus)
			if(event.touches){
				// add the newest touch addition(s); could be more than one
			}
			// Regular mouse clicks
			else {
				windowPresses |= MOUSE;
				if(event.target === BUTTON) buttonPresses |= MOUSE;
			}
			
			if(buttonPresses) BUTTON.className	= 'pressed';
			if(windowPresses) BODY.className	= 'pressed';
		}
		
		function move(event){
			// console.log(event);
		
			// If the window is being pressed at all
			if(windowPresses){
				// Touches (fingers, stylus)
				if(event.touches){
					// update all of the touches (the ids need to stay consistent; we'll have to see how browsers handle that)
				}
				// Regular mouse clicks
				else {
					// If the button is being moved onto with a pressed button, add it to the tracked presses
					if(event.target === BUTTON && !buttonPresses){
						buttonPresses |= MOUSE;
					}
					// If the button is being moved off of, track the press
					else if(event.target !== BUTTON && buttonPresses){
						incrementNumber();
						buttonPresses &= ~MOUSE;
					}
				}
				
				if(buttonPresses) BUTTON.className = 'pressed';
				else BUTTON.className = '';
				
				if(windowPresses) BODY.className	= 'pressed';
			}
		}
		
		function unpress(event){
			var pressedStart = buttonPresses;
			
			// Touches (fingers, stylus)
			if(event.touches){
				// remove the numbered touch(es); update all of the touches (the ids need to stay consistent)
			}
			// Regular mouse clicks
			else {
				windowPresses &= ~MOUSE;
				buttonPresses &= ~MOUSE;
			}
			
			// See if nothing is pressing the button anymore
			if(pressedStart && !buttonPresses){
				incrementNumber();
				BUTTON.className = '';
			}
			
			if(!windowPresses) BODY.className	= '';
		}
		
		window.addEventListener('mousedown',press);
		window.addEventListener('mouseup',unpress);
		window.addEventListener('mousemove',move);
		
		window.addEventListener('touchstart',unpress);
		window.addEventListener('touchend',unpress);
		window.addEventListener('touchmove',unpress);
	</script>
</body>
</html>